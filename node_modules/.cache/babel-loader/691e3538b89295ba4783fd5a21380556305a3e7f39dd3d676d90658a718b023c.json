{"ast":null,"code":"import { createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"box3\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_van_divider = _resolveComponent(\"van-divider\");\n  const _component_van_button = _resolveComponent(\"van-button\");\n  const _component_van_cell = _resolveComponent(\"van-cell\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_van_divider, null, {\n    default: _withCtx(() => [_createTextVNode(\"投票看板\")]),\n    _: 1 /* STABLE */\n  }), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.board, (item, index) => {\n    return _openBlock(), _createBlock(_component_van_cell, {\n      title: item.name,\n      icon: \"shop-o\"\n    }, {\n      \"right-icon\": _withCtx(() => [_createVNode(_component_van_button, {\n        onClick: $event => $setup.vote(index)\n      }, {\n        default: _withCtx(() => [_createTextVNode(_toDisplayString(item.totalAmount), 1 /* TEXT */)]),\n        _: 2 /* DYNAMIC */\n      }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"])]),\n      _: 2 /* DYNAMIC */\n    }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"title\"]);\n  }), 256 /* UNKEYED_FRAGMENT */))]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createVNode","_component_van_divider","default","_withCtx","_createTextVNode","_","_Fragment","_renderList","$setup","board","item","index","_createBlock","_component_van_cell","title","name","icon","_component_van_button","onClick","$event","vote","_toDisplayString","totalAmount"],"sources":["D:\\a\\wallet-demo\\web3-vote\\src\\views\\BoardView.vue"],"sourcesContent":["<script setup>\nimport useWeb3 from \"../hooks/useWeb3\";\nimport { ref, onMounted } from \"vue\";\nconst { web3, voteContract, getAccount } = useWeb3();\n\n// 看板信息\nconst board = ref([]);\n\nconst account = ref(\"\");\n\nconst getBoardInfo = async () => {\n  const result = await voteContract.methods.getBoardInfo().call();\n  board.value = result;\n};\n\nconst vote = async (index) => {\n  const account = await getAccount();\n  const result = await voteContract.methods.vote(index).send({ from: account });\n};\n\nconst initEventListen = () => {\n  voteContract.events\n    .voteSuccess({ fromBlock: 0 }, (err, event) => {\n      console.log(\"监听执行\");\n      console.log(event);\n    })\n    .on(\"data\", (event) => {\n      console.log(\"智能合约触发的事件：\", event.returnValues);\n    });\n};\n\nonMounted(() => {\n  initEventListen();\n  getBoardInfo();\n});\n</script>\n\n<template>\n  <div class=\"box3\">\n    <van-divider>投票看板</van-divider>\n    <van-cell :title=\"item.name\" icon=\"shop-o\" v-for=\"(item, index) in board\">\n      <template #right-icon>\n        <van-button @click=\"vote(index)\">{{ item.totalAmount }}</van-button>\n      </template>\n    </van-cell>\n  </div>\n</template>\n\n<style lang=\"less\"></style>\n"],"mappings":";;EAsCOA,KAAK,EAAC;AAAM;;;;;uBAAjBC,mBAAA,CAOM,OAPNC,UAOM,GANJC,YAAA,CAA+BC,sBAAA;IAvCnCC,OAAA,EAAAC,QAAA,CAuCiB,MAAI,CAvCrBC,gBAAA,CAuCiB,MAAI,E;IAvCrBC,CAAA;yBAwCIP,mBAAA,CAIWQ,SAAA,QA5CfC,WAAA,CAwCuEC,MAAA,CAAAC,KAAK,EAxC5E,CAwCuDC,IAAI,EAAEC,KAAK;yBAA9DC,YAAA,CAIWC,mBAAA;MAJAC,KAAK,EAAEJ,IAAI,CAACK,IAAI;MAAEC,IAAI,EAAC;;MACrB,YAAU,EAAAb,QAAA,CACnB,MAAoE,CAApEH,YAAA,CAAoEiB,qBAAA;QAAvDC,OAAK,EAAAC,MAAA,IAAEX,MAAA,CAAAY,IAAI,CAACT,KAAK;;QA1CtCT,OAAA,EAAAC,QAAA,CA0CyC,MAAsB,CA1C/DC,gBAAA,CAAAiB,gBAAA,CA0C4CX,IAAI,CAACY,WAAW,iB;QA1C5DjB,CAAA;;MAAAA,CAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}