{"ast":null,"code":"import useWeb3 from \"../hooks/useWeb3\";\nimport { ref, onMounted } from \"vue\";\nexport default {\n  __name: 'MandateView',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const {\n      web3,\n      voteContract,\n      getAccount\n    } = useWeb3();\n\n    // 定义主持人信息\n    const host = ref(\"\");\n\n    // 获取主持人信息\n    const getHost = async () => {\n      host.value = await voteContract.methods.host().call();\n    };\n\n    // 选民地址\n    const voterAddress = ref(\"\");\n\n    // 分发票权\n    const mandate = async () => {\n      const arr = eval(voterAddress.value);\n      const account = await getAccount();\n      voteContract.methods.mandate(arr).send({\n        from: account\n      }).on(\"receipt\", () => {\n        console.log(\"选票分发成功\");\n      });\n    };\n    onMounted(async () => {\n      await getHost();\n    });\n    /*\n      0x62815B4970983B8C58C2Fb649B6ba78b5BA05f70\n      0xe4525BF45E1b1Cf46A136171BD51e63f4256a0DF\n      0xE251ddBe6191594922bfd3d338529EC9C613eB67\n      0xC76E9893BB9a75730Fc61d0169241fD80AD644f6\n      [\"0xe4525BF45E1b1Cf46A136171BD51e63f4256a0DF\",\"0xE251ddBe6191594922bfd3d338529EC9C613eB67\",\"0xC76E9893BB9a75730Fc61d0169241fD80AD644f6\"]\n    */\n\n    const __returned__ = {\n      web3,\n      voteContract,\n      getAccount,\n      host,\n      getHost,\n      voterAddress,\n      mandate,\n      get useWeb3() {\n        return useWeb3;\n      },\n      ref,\n      onMounted\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["useWeb3","ref","onMounted","web3","voteContract","getAccount","host","getHost","value","methods","call","voterAddress","mandate","arr","eval","account","send","from","on","console","log"],"sources":["D:/a/wallet-demo/web3-vote/src/views/MandateView.vue"],"sourcesContent":["<script setup>\nimport useWeb3 from \"../hooks/useWeb3\";\nimport { ref, onMounted } from \"vue\";\nconst { web3, voteContract, getAccount } = useWeb3();\n\n// 定义主持人信息\nconst host = ref(\"\");\n\n// 获取主持人信息\nconst getHost = async () => {\n  host.value = await voteContract.methods.host().call();\n};\n\n// 选民地址\nconst voterAddress = ref(\"\");\n\n// 分发票权\nconst mandate = async () => {\n  const arr = eval(voterAddress.value);\n  const account = await getAccount();\n  voteContract.methods\n    .mandate(arr)\n    .send({ from: account })\n    .on(\"receipt\", () => {\n      console.log(\"选票分发成功\");\n    });\n};\n\nonMounted(async () => {\n  await getHost();\n});\n/*\n  0x62815B4970983B8C58C2Fb649B6ba78b5BA05f70\n  0xe4525BF45E1b1Cf46A136171BD51e63f4256a0DF\n  0xE251ddBe6191594922bfd3d338529EC9C613eB67\n  0xC76E9893BB9a75730Fc61d0169241fD80AD644f6\n  [\"0xe4525BF45E1b1Cf46A136171BD51e63f4256a0DF\",\"0xE251ddBe6191594922bfd3d338529EC9C613eB67\",\"0xC76E9893BB9a75730Fc61d0169241fD80AD644f6\"]\n*/\n</script>\n\n<template>\n  <div class=\"box1\">\n    <van-divider>分发票权</van-divider>\n    <div class=\"host\">\n      <van-space>\n        <p class=\"label\"><van-icon name=\"manager\" />主持人地址</p>\n        <p class=\"address\">{{ host }}</p>\n      </van-space>\n    </div>\n    <div>\n      <van-space>\n        <p class=\"label\"><van-icon name=\"friends-o\" />投票人地址</p>\n        <textarea class=\"votors\" v-model=\"voterAddress\"></textarea>\n      </van-space>\n    </div>\n    <div class=\"btn\">\n      <van-button block @click=\"mandate\">开始分发选票</van-button>\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\"></style>\n"],"mappings":"AACA,OAAOA,OAAO,MAAM,kBAAkB;AACtC,SAASC,GAAG,EAAEC,SAAS,QAAQ,KAAK;;;;;;;IACpC,MAAM;MAAEC,IAAI;MAAEC,YAAY;MAAEC;IAAW,CAAC,GAAGL,OAAO,CAAC,CAAC;;IAEpD;IACA,MAAMM,IAAI,GAAGL,GAAG,CAAC,EAAE,CAAC;;IAEpB;IACA,MAAMM,OAAO,GAAG,MAAAA,CAAA,KAAY;MAC1BD,IAAI,CAACE,KAAK,GAAG,MAAMJ,YAAY,CAACK,OAAO,CAACH,IAAI,CAAC,CAAC,CAACI,IAAI,CAAC,CAAC;IACvD,CAAC;;IAED;IACA,MAAMC,YAAY,GAAGV,GAAG,CAAC,EAAE,CAAC;;IAE5B;IACA,MAAMW,OAAO,GAAG,MAAAA,CAAA,KAAY;MAC1B,MAAMC,GAAG,GAAGC,IAAI,CAACH,YAAY,CAACH,KAAK,CAAC;MACpC,MAAMO,OAAO,GAAG,MAAMV,UAAU,CAAC,CAAC;MAClCD,YAAY,CAACK,OAAO,CACjBG,OAAO,CAACC,GAAG,CAAC,CACZG,IAAI,CAAC;QAAEC,IAAI,EAAEF;MAAQ,CAAC,CAAC,CACvBG,EAAE,CAAC,SAAS,EAAE,MAAM;QACnBC,OAAO,CAACC,GAAG,CAAC,QAAQ,CAAC;MACvB,CAAC,CAAC;IACN,CAAC;IAEDlB,SAAS,CAAC,YAAY;MACpB,MAAMK,OAAO,CAAC,CAAC;IACjB,CAAC,CAAC;IACF;AACA;AACA;AACA;AACA;AACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}